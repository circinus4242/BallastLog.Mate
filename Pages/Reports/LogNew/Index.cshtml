@page
@model BallastLog.Mate.Pages.Reports.LogNew.IndexModel
@{
    ViewData["Title"] = "Ballast Log (new) range";
}
<h2>Ballast Log Book (new) - range</h2>

<form method="get" class="flex" style="gap:1rem; align-items:flex-end; flex-wrap:wrap">
    <div><div>From (date)</div><input type="date" class="input" asp-for="FromDate" /></div>
    <div><div>To (date)</div><input type="date" class="input" asp-for="ToDate" /></div>
    <div><button class="btn" type="submit">Apply</button></div>
</form>

<table class="table small">
    <thead>
        <tr>
            <th style="width:12rem">Date</th>
            <th style="width:6rem">Code</th>
            <th style="width:6rem">Item</th>
            <th>Record of operation / signature</th>
            <th style="width:9rem">LOG</th>
            <th style="width:11rem">Action</th>
        </tr>
    </thead>
    <tbody>
        @foreach (var r in Model.Rows)
        {
            <tr>
                <td>@r.Date</td>
                <td>@r.Code</td>
                <td>@r.Item</td>
                <td style="white-space:pre-line">@r.Record</td>
                <td>@(r.FirstInOp ? (r.RecordedLog ? "Recorded" : "Not recorded") : "")</td>
                <td>
                    @if (r.FirstInOp && !r.RecordedLog)
                    {
                        <form method="post" style="display:inline">
                            <input type="hidden" name="fromDate" value="@Model.FromDate?.ToString("yyyy-MM-dd")" />
                            <input type="hidden" name="toDate" value="@Model.ToDate?.ToString("yyyy-MM-dd")" />
                            <input type="hidden" name="opId" value="@r.OpId" />
                            <button class="btn" formaction="?handler=MarkLog">Mark as recorded</button>
                        </form>
                    }
                </td>
            </tr>
        }
    </tbody>
</table>
